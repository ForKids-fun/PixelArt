<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Pixel Art Studio</title>
  <link rel="stylesheet" href="pixel.css">
</head>

<body>
  <div class="donut-rain">
  <span>游꼴</span>
  <span>游꼴</span>
  <span>游꼴</span>
  <span>游꼴</span>
  <span>游꼴</span>
  <span>游꼴</span>
  <span>游꼴</span>
</div>

<h1>游꿛 Pixel Art Studio</h1>

<!-- Color picker -->
<div class="controls">
  <input type="color" id="colorPicker" value="#000000">
  <span>Pick any color</span>
</div>

<!-- Tools -->
<div class="controls">
  <button id="paintTool">游꿛 Paint</button>
  <button id="eraseTool">游빟 Erase</button>

  <label>Eraser size:</label>
  <select id="eraserSize">
    <option value="1">1 칑 1 (tiny)</option>
    <option value="2">2 칑 2</option>
    <option value="3">3 칑 3</option>
  </select>
</div>

<!-- Grid size -->
<div class="controls">
  <label>Grid size:</label>
  <select id="gridSize">
    <option value="8">8 칑 8</option>
    <option value="16" selected>16 칑 16</option>
    <option value="32">32 칑 32</option>
  </select>
  <button onclick="createGrid()">游댃 Resize</button>
</div>

<!-- Pixel grid -->
<div id="grid"></div>

<!-- Actions -->
<div class="controls">
  <button onclick="clearGrid()">游빞 Clear</button>
  <button onclick="saveArt()">游 Save</button>
</div>

<script>
  const grid = document.getElementById("grid");
  const colorPicker = document.getElementById("colorPicker");
  const gridSizeSelect = document.getElementById("gridSize");
  const eraserSizeSelect = document.getElementById("eraserSize");
  const paintBtn = document.getElementById("paintTool");
  const eraseBtn = document.getElementById("eraseTool");

  let currentColor = colorPicker.value;
  let isPainting = false;
  let tool = "paint";

  colorPicker.oninput = () => {
    currentColor = colorPicker.value;
    tool = "paint";
  };

  paintBtn.onclick = () => tool = "paint";
  eraseBtn.onclick = () => tool = "erase";

  function createGrid() {
    const size = parseInt(gridSizeSelect.value);
    grid.innerHTML = "";
    grid.style.gridTemplateColumns = `repeat(${size}, 22px)`;

    for (let i = 0; i < size * size; i++) {
      const pixel = document.createElement("div");
      pixel.className = "pixel";

      pixel.addEventListener("mousedown", () => {
        isPainting = true;
        applyTool(i, size);
      });

      pixel.addEventListener("mouseover", () => {
        if (isPainting) applyTool(i, size);
      });

      pixel.addEventListener("contextmenu", (e) => {
        e.preventDefault();
        const bg = window.getComputedStyle(pixel).backgroundColor;
        colorPicker.value = rgbToHex(bg);
        currentColor = colorPicker.value;
        tool = "paint";
      });

      grid.appendChild(pixel);
    }
  }

  document.addEventListener("mouseup", () => isPainting = false);

  function applyTool(index, gridSize) {
    const pixels = document.querySelectorAll(".pixel");

    if (tool === "paint") {
      pixels[index].style.background = currentColor;
    } else {
      const size = parseInt(eraserSizeSelect.value);
      erasePixels(index, gridSize, size);
    }
  }

  function erasePixels(startIndex, gridSize, size) {
    const pixels = document.querySelectorAll(".pixel");
    const row = Math.floor(startIndex / gridSize);
    const col = startIndex % gridSize;

    for (let r = 0; r < size; r++) {
      for (let c = 0; c < size; c++) {
        const idx = (row + r) * gridSize + (col + c);
        if (pixels[idx]) {
          pixels[idx].style.background = "white";
        }
      }
    }
  }

  function clearGrid() {
    document.querySelectorAll(".pixel")
      .forEach(p => p.style.background = "white");
  }

  function saveArt() {
    alert("PNG export coming next 游댠游닞");
  }

  function rgbToHex(rgb) {
    const result = rgb.match(/\d+/g);
    return "#" + result.map(x =>
      ("0" + parseInt(x).toString(16)).slice(-2)
    ).join("");
  }

  createGrid();
</script>

</body>
</html>

